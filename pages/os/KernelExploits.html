<h1>Kernel Exploits</h1>

<p>
    El sexto paso de la metodología trata de buscar posibles vulnerabilidades en el sistema operativo, para identificar posibles vulnerabilidades 
    en el kernel conocidas, un atacante podría listar los parches instalados dentro del sistema y luego comprobar si le falta 
    alguna actualización importante.
</p>

<h2><i class="bi bi-check-circle me-2"></i></i>Comprobación</h2>
<p>
    Una forma rápida que suelen utilizar los atacantes para realizar esta tarea es mediante la herramienta “Windows Exploit Suggester”  
    <a class="linksref" target="_blank" href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester">
        <i class="bi bi-box-arrow-up-right"></i>
    </a>. 
    Esta herramienta utiliza la salida del comando <b>“systeminfo”</b> presente en todos los Windows, donde aparece la información sobre el sistema 
    incluyendo todos los parches instalados, y los campara con una base de datos interna de vulnerabilidades conocidas y publicadas por Microsoft.
</p>
<p class="mainComment">Utiliza el siguiente comando y copia su salida en un fichero de tu máquina atacante.</p>
<!-- Code snipet-->
<div class="snipet_custom position-relative">
<pre class="code_snipet"><code data-language="shell">systeminfo</code></pre>
</div>
<!-- Code-->

<p class="mainComment">Y para utilizar Windows Exploit Suggester.</p>
<!-- Code snipet-->
<div class="snipet_custom position-relative">
<pre class="code_snipet"><code data-language="shell">./wes.py -e [fichero_systeminfo]</code></pre>
</div>
<!-- Code-->

<p>
    Si la herramienta identifica algún parche de seguridad crítico que no haya sido instalado, mostrará un resumen de la vulnerabilidad junto a su 
    identificación y lugares de consulta para obtener más información, lo que permitirá a un atacante buscar un exploit para esa vulnerabilidad 
    para que le permita realizar una potencial elevación de privilegios en el sistema de forma rápida.
</p>




<!-- 
    ---------------------------- EJEMPLO ------------------------------------------------
-->

<h2 class="h_ejemplo"><i class="bi bi-bug-fill me-2"></i></i>EJEMPLO</h2>
<p class="mainText">
    Comenzamos ejecutando el comando <b>systeminfo</b> en la máquina para obtener todos los parches instalados y la versión del sistema operativo 
    instalada en la máquina.
</p>
<img class="img img-fluid imag_ejemplos mb-3" src="./media/imag/os/Kernel_1.png" />
<p class="mainText">
    Copiamos la salida del comando a un fichero en nuestra máquina atacante que llamaremos <b>systeminfo.txt</b> para ser analizada por la herramienta 
    <b>Windows Exploit Suggester</b>. Antes de proceder al análisis hay que recordar descargar la base de datos de actualizaciones con el parámetro 
    <b>--update</b> que generará un fichero .xls en el mismo directorio y este se lo pasamos al comando de análisis.
</p>
<img class="img img-fluid imag_ejemplos mb-3" src="./media/imag/os/Kernel_2.png" />
<p class="mainText">
    En este caso podemos ver que es vulnerable a <b>MS16-135</b> que ataca a los driver del kernel y que nos permite realizar una escalada de privilegios. 
    Es importante notar que la letra <b>[E]</b> no didica que hay exploit, si tuviera una <b>[M]</b> ya existiría módulo implementado para Metasploit.
</p>
<p class="mainText">
    Vamos entonces a utilizar el script de FuzzySec <b>MS16-135.ps1</b> para realizar la escalada a SYSTEM como se puede comprobar a continuación.
</p class="mainText">
<img class="img img-fluid imag_ejemplos mb-3" src="./media/imag/os/Kernel_3.png" />
<br>
<p class="mainComment">
    Este sólo es uno de los muchos ejemplos que podrían verse en este apartado, ya que habría que adaptarse a cada caso en función de 
    la vulnerabilidad encontrada y los exploits disponibles.
</p>
